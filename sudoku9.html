<html>
   <head>
      <script type = "text/javascript">
	  function generate_sudoku() {
	  let count=9;
		let body = document.getElementsByTagName("body")[0];
		let tbl = document.createElement("table");
	  	let tblBody = document.createElement("tbody");
	  	for (let i = 0; i < count; i++) {
	    	let row = document.createElement("tr");
	    	for (let j = 0; j < count; j++) {
	      		let cell = document.createElement("td");
				cell.setAttribute("contenteditable","true");
	      		let cellText = document.createTextNode("");
	      		cell.appendChild(cellText);
	      		row.appendChild(cell);
	    	}
	    	tblBody.appendChild(row);
	  	}tbl.appendChild(tblBody);
	  	body.appendChild(tbl);
		}
		function solve_sudoku(){
			let count=9,counter=0;
			console.log("solving");
			let result=[],rowi=[],colj=[],square=[],sol=[];
			let body = document.getElementsByTagName("body")[0];
			let tbl = body.getElementsByTagName("table")[0];
			let tblbody = tbl.getElementsByTagName("tbody")[0];
			for(let i=0;i<count;i++){
			row = tblbody.getElementsByTagName("tr")[i];
				result[i]=[];
				for(let j=0;j<count;j++){
					col = row.getElementsByTagName("td")[j];
					cellvalue=col.childNodes[0];
					result[i][j]=cellvalue.data;
				}
			}
			sol=result;
			for(let i=0;i<count;i++){
				for(let j=0;j<count;j++){
					if(sol[i][j] !== ""){
						counter++;
					}
				}
			}
			console.log(counter);
			function findsquare(i,j){
				if(i%9<3){
					if(j%9<3){
						for(let l=0,k=0;l<3;l++,k++){
							for(let m=0;m<3;m++,k++){
								square[k]=result[l][m];
							}
						}	
					}
					else if(j%9<6){
						for(let l=0,k=0;l<3;l++,k++){
							for(let m=3;m<6;m++,k++){
								square[k]=result[l][m];
							}
						}
					}
					else{
						for(let l=0,k=0;l<3;l++,k++){
							for(let m=6;m<9;m++,k++){
								square[k]=result[l][m];
							}
						}
					}
				}
				else if(i%9<6){
					if(j%9<3){
						for(let l=3,k=0;l<3;l++,k++){
							for(let m=0;m<3;m++,k++){
								square[k]=result[l][m];
							}
						}
					}
					else if(j%9<6){
						for(let l=3,k=0;l<3;l++,k++){
							for(let m=3;m<6;m++,k++){
								square[k]=result[l][m];
							}
						}
					}
					else{
						for(let l=3,k=0;l<3;l++,k++){
							for(let m=6;m<9;m++,k++){
								square[k]=result[l][m];
							}
						}
					}
				}
				else if(j%9<3){
					for(let l=6,k=9;l<3;l++,k++){
						for(let m=0;m<3;m++,k++){
							square[k]=result[l][m];
						}
					}
				}
				else if(j%9<6){
					for(let l=6,k=9;l<3;l++,k++){
						for(let m=3;m<6;m++,k++){
							square[k]=result[l][m];
						}
					}
				}
				else{
					for(let l=6,k=9;l<3;l++,k++){
						for(let m=6;m<9;m++,k++){
							square[k]=result[l][m];
						}
					}
				}
				return square;
			}
			while(counter<81){
				for(let i=0;i<count;i++){
					for(let j=0;j<count;j++){
						if(result[i][j] === ""){
							for(let k=0;k<count;k++){
								rowi[k]=result[i][k];
							}
							for(let k=0;k<count;k++){
								colj[k]=result[k][j];
							}
							/*if((i === 0 || i === 1 || i === 2) && (j === 0 || j === 1 || j === 2)) {
								for(let l=0,k=0;l<count/3;l++,k++){
									for(let m=0;m<count/3;m++,k++){
										square[k]=result[l][m];
									}
								}
							}
							else if((i === 0 || i === 1 || i === 2) && (j === 3 || j === 4 || j === 5)){
								for(let l=0,k=0;l<count/3;l++,k++){
									for(let m=3;m<count/3;m++,k++){
										square[k]=result[l][m];
									}
								}
							}
							else if((i === 2 || i === 3) && (j === 0 || j === 1 || j === 2)){
								for(let l=2,k=0;l<4;l++,k++){
									for(let m=0;m<count/2;m++,k++){
										square[k]=result[l][m];
									}
								}
							}
							else if((i === 2 || i === 3) && (j === 3 || j === 4 || j === 5)){
								for(let l=2,k=0;l<4;l++,k++){
									for(let m=3;m<count;m++,k++){
										square[k]=result[l][m];
									}
								}
							}
							else if((i === 4 || i === 5) && (j === 0 || j === 1 || j === 2)){
								for(let l=4,k=0;l<count;l++,k++){
									for(let m=0;m<count/2;m++,k++){
										square[k]=result[l][m];
									}
								}
							}
							else if((i === 4 || i === 5) && (j === 3 || j === 4 || j === 5)){
								for(let l=4,k=0;l<count;l++,k++){
									for(let m=3;m<count;m++,k++){
										square[k]=result[l][m];
									}
								}
							}*/
							findsquare(i,j);
							function notincluded(value){
								return (!rowi.includes(value) && !colj.includes(value) && !square.includes(value));
							}
							temp=Array.from('123456789').filter(notincluded);
							tbl.rows[i].cells[j].innerHTML=temp;
							if(temp.length === 1){
								sol[i][j]=temp[0];
								result[i][j]=temp[0];
								counter++;
								console.log(result[i][j]);
								console.log(counter);
							}
						}
					}
				}
			}
		}
	  </script>
	  <link rel="stylesheet" href="sudoku.css">
	</head>
   
   <body>
     <input type="button" value="Create Sudoku" onclick="generate_sudoku()">
	<input type="button" value="Solve Sudoku" onclick="solve_sudoku()">
   </body>
</html>
